CRUD :  ì •ë³´ê´€ë¦¬ì˜ ê¸°ë³¸ ê¸°ëŠ¥
ìƒì„±(Create)
ì¡°íšŒ(Read)
ë³€ê²½(Update)
ì‚­ì œ(Delete)



week02Application.javaë¡œê°€ì„œ
return (args) -> { ë°‘ì— ë‹¤ ì§€ìš°ê³ 

'''''

// ë°ì´í„° ì €ì¥í•˜ê¸°
repository.save(new Course("í”„ë¡ íŠ¸ì—”ë“œì˜ ê½ƒ, ë¦¬ì•¡íŠ¸", "ì„ë¯¼ì˜"));

// ë°ì´í„° ì „ë¶€ ì¡°íšŒí•˜ê¸°
List<Course> courseList = repository.findAll();
for (int i=0; i<courseList.size(); i++) {
    Course course = courseList.get(i);
    System.out.println(course.getId());
    System.out.println(course.getTitle());
    System.out.println(course.getTutor());
}

// ë°ì´í„° í•˜ë‚˜ ì¡°íšŒí•˜ê¸°
Course course = repository.findById(1L).orElseThrow( //int ê°€ ì•„ë‹ˆë¼ long ì´ë¼ì„œ () ì•ˆì— 1ë§Œì“°ë©´ ì•ˆë˜ê³  Lë„ ì¶”ê°€ë¡œ ë¶™ì—¬ì¤˜ì•¼í•¨. ì—¬ê¸°ê¹Œì§€ë§Œ ì¹˜ë©´ ë¹¨ê°„ì¤„ë‚˜ì˜´. í•´ë‹¹ ì•„ì´ë””ì— ë­ ì—†ìœ¼ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ì§€ë¥¼ ì•ˆì •í•´ì¤˜ì„œê·¸ë˜. orElseThrow í•´ì„œ ì—†ì„ë•Œë¥¼ ì„¤ì •í•´ì£¼ì.
        () -> new IllegalArgumentException("í•´ë‹¹ ì•„ì´ë””ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")
);

'''''
ë¶™ì—¬ë„£ê¸°

ì´ëŸ¬ë©´ getId() ê°€ ë¹¨ê°„ì¤„ì´ ê·¸ì–´ì§ˆí…ë°
Course.java ê°€ì„œ getId ë„ ë§Œë“¤ì–´ì£¼ì

public Long getId() {
	return this.id;
}
































ì—…ë°ì´íŠ¸, ë”œë¦¬íŠ¸ë¥¼ í•˜ë ¤ë©´ ì„œë¹„ìŠ¤ì— ëŒ€í•´ ì•Œì•„ì•¼í•¨.
ğŸ‘‰ update, delete ë¡œ ë„˜ì–´ê°€ê¸° ì „ì—, ë‹¤ë£¨ì–´ì•¼ í•˜ëŠ” ê°œë…ì´ ë°”ë¡œ Service ì…ë‹ˆë‹¤.



- ìŠ¤í”„ë§ì˜ êµ¬ì¡°ëŠ” 3ê°€ì§€ ì˜ì—­ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    1. Controller : ê°€ì¥ ë°”ê¹¥ ë¶€ë¶„, ìš”ì²­/ì‘ë‹µì„ ì²˜ë¦¬í•¨.
        
        â†’ 2ì£¼ì°¨ í›„ë°˜ë¶€ì— ë°°ìš¸ ë…€ì„
        
    2. Service : ì¤‘ê°„ ë¶€ë¶„, ì‹¤ì œ ì¤‘ìš”í•œ ì‘ë™ì´ ë§ì´ ì¼ì–´ë‚˜ëŠ” ë¶€ë¶„
        
        â†’ ì§€ê¸ˆ ë°°ìš¸ ë…€ì„
        
    3. Repo : ê°€ì¥ ì•ˆìª½ ë¶€ë¶„, DBì™€ ë§ë‹¿ì•„ ìˆìŒ.
        
        â†’ ì—¬íƒœ ë°°ìš´ ë…€ì„ (Repository, Entity)
        
- Update ëŠ” Service ë¶€ë¶„ì— ì‘ì„±í•©ë‹ˆë‹¤.





1. ë¨¼ì € Course.java ì—ë‹¤ê°€

''''''

public void update(Course course) {
    this.title = course.title;
    this.tutor = course.tutor;
}

''''''
ì—…ë°ì´íŠ¸ ë©”ì†Œë“œ ë„£ì–´ì•¼í•¨.


2. src > main > java > com.sparta.week02 > service íŒ¨í‚¤ì§€ ìƒì„±í•˜ê¸°

3. íŒ¨í‚¤ì§€ì— CourseService.java ë§Œë“¤ê¸°

4. 

'''''

@Service // ìŠ¤í”„ë§ì—ê²Œ ì´ í´ë˜ìŠ¤ëŠ” ì„œë¹„ìŠ¤ì„ì„ ëª…ì‹œ
public class CourseService {

		// final: ì„œë¹„ìŠ¤ì—ê²Œ ê¼­ í•„ìš”í•œ ë…€ì„ì„ì„ ëª…ì‹œ
    private final CourseRepository courseRepository;

		// ìƒì„±ìë¥¼ í†µí•´, Service í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ ë•Œ ê¼­ Repositoryë¥¼ ë„£ì–´ì£¼ë„ë¡
		// ìŠ¤í”„ë§ì—ê²Œ ì•Œë ¤ì¤Œ
    public CourseService(CourseRepository courseRepository) {
        this.courseRepository = courseRepository;
    }

    @Transactional // SQL ì¿¼ë¦¬ê°€ ì¼ì–´ë‚˜ì•¼ í•¨ì„ ìŠ¤í”„ë§ì—ê²Œ ì•Œë ¤ì¤Œ
    public Long update(Long id, Course course) {
        Course course1 = courseRepository.findById(id).orElseThrow(
                () -> new IllegalArgumentException("í•´ë‹¹ ì•„ì´ë””ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")
        );
        course1.update(course);
        return course1.getId();
    }
}

'''''
ë¶™ì—¬ë„£ê¸°

courseRepository ëŠ” ëˆ„ê°€ ë§Œë“¤ì–´ì£¼ëƒ? CouseService ìƒì„±í• ë•Œ ìŠ¤í”„ë§ì´ ì•Œì•„ì„œ ë§Œë“¤ì–´ì¤Œ

ê·¸ ë°‘ì— Transactional ìª½ì„ ë³´ë©´
Longì€ ì—…ë°ì´íŠ¸ ë˜ì—ˆì„ë•Œ ì–´ë–¤  id ê°€ ë˜ì—ˆëŠ”ì§€ë¥¼ ëŒë ¤ì£¼ëŠ” ê±°ì„. ì „ë‹¬ë°›ëŠ”ê±°ëŠ” ë‘ê°œì˜ ì¬ë£Œê°€ í•„ìš”í•¨. Id ë‘ ì—…ë°ì´íŠ¸í•  ë…€ì„ì˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ë…€ì„.
ê·¸ë‹¤ìŒì— ì—…ë°ì´íŠ¸í•  ë…€ì„ì„ ì°¾ì•„ì„œ course1ì„ ìƒì„±í•˜ì—¬ ë„£ì–´ì¤Œ
course1ì´ ì—…ë°ì´íŠ¸ ë˜ë„ë¡ ë©”ì†Œë¥¼ ì„¤ì •. course1.update(course); ì´ë•Œ ê´„í˜¸ì•ˆì˜ course ëŠ” ì´ ë©”ì†Œë“œì— í•„ìš”í•œ ì¬ë£Œì¤‘ì—
courseê°€ ìˆëŠ”ë° ê·¸ê±°ì„.
ê·¸ë¦¬ê³  ì—…ë°ì´íŠ¸ í•´ì¤€ ë…€ì„ì˜ ì•„ì´ë””ë¥¼ ë¦¬í„´í•˜ëŠ” 
return course1.getId();









week02Application.java ì—ë‹¤ê°€

'''''

@Bean
public CommandLineRunner demo(CourseRepository courseRepository, CourseService courseService) {
    return (args) -> {
        courseRepository.save(new Course("í”„ë¡ íŠ¸ì—”ë“œì˜ ê½ƒ, ë¦¬ì•¡íŠ¸", "ì„ë¯¼ì˜"));

        System.out.println("ë°ì´í„° ì¸ì‡„");
        List<Course> courseList = courseRepository.findAll();
        for (int i=0; i<courseList.size(); i++) {
            Course course = courseList.get(i);
            System.out.println(course.getId());
            System.out.println(course.getTitle());
            System.out.println(course.getTutor());
        } //ì—¬ê¸°ê¹Œì§€ ìš°ì„  ìƒì„±í•´ ë†“ê³  ë¶ˆëŸ¬ì™€ì„œ ì½ì–´ë³´ëŠ” ê³¼ì •ì„.

        Course new_course = new Course("ì›¹ê°œë°œì˜ ë´„, Spring", "ì„ë¯¼ì˜"); //ê°•ì˜ì œëª©ë§Œ ë°”ë€ ì—…ë°ì´íŠ¸
        courseService.update(1L, new_course); //ì•„ì´ë””ê°€ 1ì¸ ë…€ì„ì„ ê°€ì§€ê³  ë³€ê²½í•  ì½”ìŠ¤ë¥¼ ë„˜ê²¨ì¤€ë‹¤
        courseList = courseRepository.findAll();
        for (int i=0; i<courseList.size(); i++) {
            Course course = courseList.get(i);
            System.out.println(course.getId());
            System.out.println(course.getTitle());
            System.out.println(course.getTutor());
        }
    };
}

'''''
ë¶™ì—¬ë„£ê¸°

















ë”œë¦¬íŠ¸ëŠ” ì–´ì¼€í•¨?

@Bean
public CommandLineRunner demo(CourseRepository courseRepository, CourseService courseService) {
    return (args) -> {
        courseRepository.save(new Course("í”„ë¡ íŠ¸ì—”ë“œì˜ ê½ƒ, ë¦¬ì•¡íŠ¸", "ì„ë¯¼ì˜"));

        System.out.println("ë°ì´í„° ì¸ì‡„");
        List<Course> courseList = courseRepository.findAll();
        for (int i=0; i<courseList.size(); i++) {
            Course course = courseList.get(i);
            System.out.println(course.getId());
            System.out.println(course.getTitle());
            System.out.println(course.getTutor());
        }

        Course new_course = new Course("ì›¹ê°œë°œì˜ ë´„, Spring", "ì„ë¯¼ì˜");
        courseService.update(1L, new_course);
        courseList = courseRepository.findAll();
        for (int i=0; i<courseList.size(); i++) {
            Course course = courseList.get(i);
            System.out.println(course.getId());
            System.out.println(course.getTitle());
            System.out.println(course.getTutor());
        }

        courseRepository.deleteAll();      <---------------------------------------ì´ê±° í•œì¤„ ì¶”ê°€í•˜ë©´ ì‹¹ ì‚¬ë¼ì§
    };
}